<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.library.mapper.LibMapper">


<!-- 책 등록 -->

<insert id="insertBookInfo" parameterType="com.library.dto.BookDTO">
   insert into book_info(isbn, title, author, publisher,category)
      values (#{isbn},#{title},#{author},#{publisher},#{category})
   
   </insert>	
  

<insert id="insertBooks" parameterType="com.library.dto.BookDTO">
insert into books(isbn,b_status,stock_count_status,due_date) 
   values (#{isbn},"A",null,null);
   </insert>	
    
    
<!-- -->
<select id="selectBookInfo" resultType="int" parameterType="string">
  	
  		select count(*) 
  		from book_info 
  		where isbn = #{isbn}
  	
	</select>


<select id="bringBooksInfo" resultType="com.library.dto.BookDeleteDto" parameterType="String">
    SELECT books.b_id, books.isbn, book_info.title, book_info.author
    FROM books
    JOIN book_info ON books.isbn = book_info.isbn
    WHERE books.isbn = #{isbn} AND books.b_status != 'B'
</select>


<update id="deleteBook" parameterType="com.library.dto.BookDeleteDto">
   update books
   set
      b_status = "B"
   where
      b_id = #{b_id}
</update>




</mapper>