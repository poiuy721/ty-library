<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.library.mapper.adminStockMapper">

	<!-- update -->
	<update id="updateInitialNStock">
		UPDATE books
		SET STOCK_COUNT_STATUS = 'N'
		WHERE
		B_STATUS != 'Y'
	</update>

	<update id="updateyStockByBId" parameterType="String">
		UPDATE BOOKS
		SET
		STOCK_COUNT_STATUS = 'Y'
		WHERE B_ID = #{id}
	</update>
	
	<update id="updateNStatusByBid" parameterType="String">
		UPDATE BOOKS
		SET
		B_STATUS = 'N'
		WHERE B_ID = #{id}
	</update>


	<!-- select -->
	<select id="selectBooksByBId" parameterType="string"
		resultType="com.library.dto.StockBookDTO">
		select book_info.TITLE, books.B_ID
		from book_info
		join books 
		on book_info.ISBN = books.ISBN 
		WHERE B_ID = #{id}
	</select>



	<!-- 대여중 조회 -->
	<select id="selectBooksByYState"
		resultType="com.library.dto.BooksDTO">
		SELECT *
		FROM books
		WHERE B_STATUS = 'Y'
	</select>
	<!-- 대여 아닌거 재고 상태 조회 -->
	<select id="selectBooksByNStateAndNStock"
		resultType="com.library.dto.BooksDTO">
		SELECT *
		FROM books
		WHERE B_STATUS = 'N' AND
		STOCK_COUNT_STATUS = 'N'
	</select>
	<select id="selectBooksByNStateAndYStock"
		resultType="com.library.dto.BooksDTO">
		SELECT *
		FROM books
		WHERE B_STATUS = 'N' AND
		STOCK_COUNT_STATUS = 'Y'
	</select>
	
	<!-- 조인쿼리 셀렉 -->
	<select id="selectBooksByNStockNBook"
		resultType="com.library.dto.StockBookDTO">
		select book_info.TITLE, books.B_ID
		from book_info
		join books 
		on book_info.ISBN = books.ISBN 
		and books.STOCK_COUNT_STATUS = 'N' 
		and books.B_STATUS = 'N'
	</select>
	
	<select id="selectBooksByYStockNBook"
		resultType="com.library.dto.StockBookDTO">
		select book_info.TITLE, books.B_ID
		from book_info
		join books 
		on book_info.ISBN = books.ISBN 
		and books.STOCK_COUNT_STATUS = 'Y' 
		and books.B_STATUS = 'N'
	</select>
	



	<select id="getIds">
		SELECT B_ID
		FROM BOOKS
	</select>







</mapper>